# Rt over time
g <- ggplot(r, aes(x=date, y=avg_r_avg)) +
geom_line() +
geom_ribbon(aes(x=date,
ymin = avg_r_lower,
ymax = avg_r_upper,
fill = NULL,
alpha = 0.3)) +
geom_hline(yintercept=1, linetype="dashed") +
facet_wrap(~region,scales="free") +
labs(title="Effective Reproduction Number (Rt) - Weighted Average",
x="Date (2020-2021)", y="Rt") +
coord_cartesian(ylim = c(0.6,1.67), xlim = c(as.Date("2020-09-04"),as.Date("2021-02-10"))) +
theme(legend.position = "none")
g + guides(alpha="none")
# Export plot
ggsave("plots/Rt over time.png", width = 8, height = 5, units = "in")
# # Trial to combine RNA and incidence plots (2 axis scales)
# max_rna <- max(data$weighted_avg_sars_cov2)
# max_rolling <- max(case$rolling)
#
# d2 <- gather(d1, 'var', 'val', stones:revenue) %>%
#   mutate(val = if_else(var == 'revenue', as.double(val), val / (max_rolling / max_rna)))
#
# ggplot() +
#   geom_line(data, mapping = aes(x=date, y=gene_copies_per_day)) +
#   geom_line(case, mapping = aes(x=date, y=rolling)) +
#   geom_point(raw, mapping = aes(x=date, y=sars_cov2_gc_l_mean),
#              colour="red", size=0.1, alpha=0.3) +
#   facet_wrap(~region,scales="free") +
#   labs(title="Weighted and Interpolated Level of SARS-CoV-2") +
#   xlab("Date (2020-2021)") +
#   ylab("Weighted Average RNA Level (gc/l)") +
#   scale_y_continuous(limits=c(0,4e5), sec.axis = sec_axis(trans = ~ . * (max_stones / max_revenue),
#                                                           name = 'number of stones'),
#                      labels = dollar)
# ----------------------------------------------------------------
# title: Exploratory data analysis of wastewater data of SARS-CoV-2 in from
#        45 sewage treatment works in England from July 2020 to February 2021
# data source: Morvan et al., UKHSA
# https://doi.org/10.1038/s41467-022-31753-y
# ----------------------------------------------------------------
library(tidyverse)
library(patchwork)
# Set themes for plots
theme_set(theme_minimal())
# Read in data
data <- read.csv("./data/linked_data.csv")
case <- read.csv("./data/cleaned_cases.csv")
r <- read.csv("./data/weighted_r.csv")
raw <- read.csv("./data/agg_data_with_region.csv")
# Remove index column 'X' if present
lst1 <- list(data=data, r=r, raw=raw)
list2env(lapply(lst1,`[`,-1), envir=.GlobalEnv)
# Convert date from string to date
data$date <- lubridate::ymd(data$date)
case$date <- lubridate::ymd(case$date)
r$date <- lubridate::ymd(r$date)
raw$date <- lubridate::ymd(raw$date)
# Re-order groups for plots
neworder <- c('North West', 'Yorkshire And The Humber', 'North East',
'West Midlands', 'East Midlands', 'East Of England',
'South West','London' , 'South East')
data <- arrange(mutate(data,
region=factor(region,levels=neworder)),region)
case <- arrange(mutate(case,
region=factor(region,levels=neworder)),region)
r <- arrange(mutate(r,
region=factor(region,levels=neworder)),region)
raw <- arrange(mutate(raw,
region=factor(region,levels=neworder)),region)
# Weighted and interpolated VS actual RNA levels
g <- ggplot() +
geom_line(data, mapping = aes(x=date, y=weighted_avg_sars_cov2,
color='Interpolated', alpha=0.7)) +
geom_line(data, mapping = aes(x=date, y=rna_7d_avg,
color='7-day Average')) +
geom_point(raw, mapping = aes(x=date, y=sars_cov2_gc_l_mean),
colour="grey70", shape=1, size=0.1, alpha=0.3) +
facet_wrap(~region,scales="free") +
scale_color_manual(labels = c("7-day Average", "Interpolated"),
values = c("tomato", "dodgerblue")) +
labs(title="SARS-CoV-2 RNA Concentration - Weighted Average",
x="Date (2020-2021)",
y="RNA Concentration (gc/l)",
color="Legend") +
coord_cartesian(ylim = c(0,5e5))
g + guides(alpha='none')
# Export plot
ggsave("plots/RNA over time.png", width = 8, height = 5, units = "in")
# Incidence over time
ggplot(case) +
geom_line(aes(x=date, y=newCasesBySpecimenDate, color='blue')) +
geom_line(aes(x=date, y=cases_7d_avg, color='red')) +
facet_wrap(~region,scales="free") +
labs(title = "Incidence of SARS-CoV-2",
x = "Date (2020-2021)",
y = "New Cases by Specimen Date",
color = "Legend") +
scale_color_manual(labels = c("Actual case no.", "7-day average"),
values = c("dodgerblue", "tomato")) +
coord_cartesian(ylim = c(0,16000), xlim = c(as.Date("2020-09-04"),as.Date("2021-02-10")))
# Export plot
ggsave("plots/Incidence over time.png", width = 8, height = 5, units = "in")
# Rt over time
g <- ggplot(r, aes(x=date, y=avg_r_avg)) +
geom_line() +
geom_ribbon(aes(x=date,
ymin = avg_r_lower,
ymax = avg_r_upper,
fill = NULL,
alpha = 0.3)) +
geom_hline(yintercept=1, linetype="dashed") +
facet_wrap(~region,scales="free") +
labs(title="Effective Reproduction Number (Rt) - Weighted Average",
x="Date (2020-2021)", y="Rt") +
coord_cartesian(ylim = c(0.6,1.67), xlim = c(as.Date("2020-09-04"),as.Date("2021-02-10"))) +
theme(legend.position = "none")
g + guides(alpha="none")
# Export plot
ggsave("plots/Rt over time.png", width = 8, height = 5, units = "in")
# # Trial to combine RNA and incidence plots (2 axis scales)
# max_rna <- max(data$weighted_avg_sars_cov2)
# max_rolling <- max(case$rolling)
#
# d2 <- gather(d1, 'var', 'val', stones:revenue) %>%
#   mutate(val = if_else(var == 'revenue', as.double(val), val / (max_rolling / max_rna)))
#
# ggplot() +
#   geom_line(data, mapping = aes(x=date, y=gene_copies_per_day)) +
#   geom_line(case, mapping = aes(x=date, y=rolling)) +
#   geom_point(raw, mapping = aes(x=date, y=sars_cov2_gc_l_mean),
#              colour="red", size=0.1, alpha=0.3) +
#   facet_wrap(~region,scales="free") +
#   labs(title="Weighted and Interpolated Level of SARS-CoV-2") +
#   xlab("Date (2020-2021)") +
#   ylab("Weighted Average RNA Level (gc/l)") +
#   scale_y_continuous(limits=c(0,4e5), sec.axis = sec_axis(trans = ~ . * (max_stones / max_revenue),
#                                                           name = 'number of stones'),
#                      labels = dollar)
# Weighted and interpolated VS actual RNA levels
g <- ggplot() +
geom_line(data, mapping = aes(x=date, y=rna_7d_avg,
color='7-day Average')) +
geom_line(data, mapping = aes(x=date, y=weighted_avg_sars_cov2,
color='Interpolated', alpha=0.7)) +
geom_point(raw, mapping = aes(x=date, y=sars_cov2_gc_l_mean),
colour="grey70", shape=1, size=0.1, alpha=0.3) +
facet_wrap(~region,scales="free") +
scale_color_manual(labels = c("Interpolated", "7-day Average"),
values = c("dodgerblue", "tomato")) +
labs(title="SARS-CoV-2 RNA Concentration - Weighted Average",
x="Date (2020-2021)",
y="RNA Concentration (gc/l)",
color="Legend") +
coord_cartesian(ylim = c(0,5e5))
g + guides(alpha='none')
# Weighted and interpolated VS actual RNA levels
g <- ggplot() +
geom_line(data, mapping = aes(x=date, y=weighted_avg_sars_cov2,
color='Interpolated', alpha=0.7)) +
geom_line(data, mapping = aes(x=date, y=rna_7d_avg,
color='7-day Average')) +
geom_point(raw, mapping = aes(x=date, y=sars_cov2_gc_l_mean,
colour="grey70", shape=1, size=0.1, alpha=0.3)) +
facet_wrap(~region,scales="free") +
scale_color_manual(labels = c("Interpolated", "7-day Average"),
values = c("dodgerblue", "tomato")) +
labs(title="SARS-CoV-2 RNA Concentration - Weighted Average",
x="Date (2020-2021)",
y="RNA Concentration (gc/l)",
color="Legend") +
coord_cartesian(ylim = c(0,5e5))
g + guides(alpha='none')
# Weighted and interpolated VS actual RNA levels
g <- ggplot() +
geom_line(data, mapping = aes(x=date, y=weighted_avg_sars_cov2,
color='Interpolated', alpha=0.7)) +
geom_line(data, mapping = aes(x=date, y=rna_7d_avg,
color='7-day Average')) +
geom_point(raw, mapping = aes(x=date, y=sars_cov2_gc_l_mean,
colour="grey70", size=0.1, alpha=0.3)) +
facet_wrap(~region,scales="free") +
scale_color_manual(labels = c("Interpolated", "7-day Average"),
values = c("dodgerblue", "tomato")) +
labs(title="SARS-CoV-2 RNA Concentration - Weighted Average",
x="Date (2020-2021)",
y="RNA Concentration (gc/l)",
color="Legend") +
coord_cartesian(ylim = c(0,5e5))
g + guides(alpha='none')
# Weighted and interpolated VS actual RNA levels
g <- ggplot() +
geom_line(data, mapping = aes(x=date, y=weighted_avg_sars_cov2,
color='Interpolated', alpha=0.7)) +
geom_line(data, mapping = aes(x=date, y=rna_7d_avg,
color='7-day Average')) +
geom_point(raw, mapping = aes(x=date, y=sars_cov2_gc_l_mean,
colour="Actual", size=0.1, alpha=0.3)) +
facet_wrap(~region,scales="free") +
scale_color_manual(labels = c("Interpolated", "7-day Average", "Actual"),
values = c("dodgerblue", "tomato", "grey70")) +
labs(title="SARS-CoV-2 RNA Concentration - Weighted Average",
x="Date (2020-2021)",
y="RNA Concentration (gc/l)",
color="Legend") +
coord_cartesian(ylim = c(0,5e5))
g + guides(alpha='none')
# Weighted and interpolated VS actual RNA levels
g <- ggplot() +
geom_line(data, mapping = aes(x=date, y=weighted_avg_sars_cov2,
color='Interpolated', alpha=0.7)) +
geom_line(data, mapping = aes(x=date, y=rna_7d_avg,
color='7-day Average')) +
geom_point(raw, mapping = aes(x=date, y=sars_cov2_gc_l_mean, alpha=0.3),
colour="grey70", shape=1, size=0.1) +
facet_wrap(~region,scales="free") +
scale_color_manual(labels = c("Interpolated", "7-day Average"),
values = c("dodgerblue", "tomato")) +
labs(title="SARS-CoV-2 RNA Concentration - Weighted Average",
x="Date (2020-2021)",
y="RNA Concentration (gc/l)",
color="Legend") +
coord_cartesian(ylim = c(0,5e5))
g + guides(alpha='none')
# Weighted and interpolated VS actual RNA levels
g <- ggplot() +
geom_line(data, mapping = aes(x=date, y=weighted_avg_sars_cov2,
color='Interpolated')) +
geom_line(data, mapping = aes(x=date, y=rna_7d_avg,
color='7-day Average')) +
geom_point(raw, mapping = aes(x=date, y=sars_cov2_gc_l_mean),
colour="grey70", shape=1, size=0.1, alpha=0.3) +
facet_wrap(~region,scales="free") +
scale_color_manual(labels = c("7-day Average", "Interpolated"),
values = c("tomato", "dodgerblue")) +
labs(title="SARS-CoV-2 RNA Concentration - Weighted Average",
x="Date (2020-2021)",
y="RNA Concentration (gc/l)",
color="Legend") +
coord_cartesian(ylim = c(0,5e5))
g + guides(alpha='none')
# Weighted and interpolated VS actual RNA levels
g <- ggplot() +
geom_line(data, mapping = aes(x=date, y=weighted_avg_sars_cov2,
color='Interpolated')) +
geom_line(data, mapping = aes(x=date, y=rna_7d_avg,
color='7-day Average')) +
geom_point(raw, mapping = aes(x=date, y=sars_cov2_gc_l_mean),
colour="grey70", shape=1, size=0.1, alpha=0.2) +
facet_wrap(~region,scales="free") +
scale_color_manual(labels = c("7-day Average", "Interpolated"),
values = c("tomato", "dodgerblue")) +
labs(title="SARS-CoV-2 RNA Concentration - Weighted Average",
x="Date (2020-2021)",
y="RNA Concentration (gc/l)",
color="Legend") +
coord_cartesian(ylim = c(0,5e5))
g + guides(alpha='none')
# Weighted and interpolated VS actual RNA levels
g <- ggplot() +
geom_line(data, mapping = aes(x=date, y=weighted_avg_sars_cov2,
color='Interpolated')) +
geom_line(data, mapping = aes(x=date, y=rna_7d_avg,
color='7-day Average')) +
geom_point(raw, mapping = aes(x=date, y=sars_cov2_gc_l_mean),
colour="grey70", shape=1, size=0.1, alpha=0.4) +
facet_wrap(~region,scales="free") +
scale_color_manual(labels = c("7-day Average", "Interpolated"),
values = c("tomato", "dodgerblue")) +
labs(title="SARS-CoV-2 RNA Concentration - Weighted Average",
x="Date (2020-2021)",
y="RNA Concentration (gc/l)",
color="Legend") +
coord_cartesian(ylim = c(0,5e5))
g + guides(alpha='none')
# Weighted and interpolated VS actual RNA levels
g <- ggplot() +
geom_line(data, mapping = aes(x=date, y=weighted_avg_sars_cov2,
color='Interpolated')) +
geom_line(data, mapping = aes(x=date, y=rna_7d_avg,
color='7-day Average')) +
geom_point(raw, mapping = aes(x=date, y=sars_cov2_gc_l_mean),
colour="grey70", shape=1, size=0.1, alpha=0.5) +
facet_wrap(~region,scales="free") +
scale_color_manual(labels = c("7-day Average", "Interpolated"),
values = c("tomato", "dodgerblue")) +
labs(title="SARS-CoV-2 RNA Concentration - Weighted Average",
x="Date (2020-2021)",
y="RNA Concentration (gc/l)",
color="Legend") +
coord_cartesian(ylim = c(0,5e5))
g + guides(alpha='none')
# Export plot
ggsave("plots/RNA over time.png", width = 8, height = 5, units = "in")
# Plot
r1 <- ggplot(data=rna_r1_sim, aes(x=rna_t, y=rna_t_minus_7)) +
geom_point(color='green', size=1) +
labs(title= "\u03b2 = 0.15") +
xlab("RNA level on day t (gc/day)") +
ylab("RNA level on day t-7 (gc/day)") +
theme(legend.text=element_text(size=8)) +
scale_x_continuous(limits=c(0,2e14),
breaks=seq(0,2e14,1e14)) +
scale_y_continuous(limits=c(0,2e14))
r2 <- ggplot(data=rna_r2_sim, aes(x=rna_t, y=rna_t_minus_7)) +
geom_point(color='yellow', size=1) +
labs(title= "\u03b2 = 0.2") +
xlab("RNA level on day t (gc/day)") +
ylab("RNA level on day t-7 (gc/day)") +
theme(legend.text=element_text(size=8)) +
scale_x_continuous(limits=c(0,2e14),
breaks=seq(0,2e14,1e14)) +
scale_y_continuous(limits=c(0,2e14))
r3 <- ggplot(data=rna_r3_sim, aes(x=rna_t, y=rna_t_minus_7)) +
geom_point(color='blue', size=1) +
labs(title= "\u03b2 = 0.3") +
xlab("RNA level on day t (gc/day)") +
ylab("RNA level on day t-7 (gc/day)") +
theme(legend.text=element_text(size=8)) +
scale_x_continuous(limits=c(0,2e14),
breaks=seq(0,2e14,1e14))
# Show three graphs horizontally
r1 + r2 + r3
ggsave("plots/Betas combined.png", width = 8, height = 3, units = "in")
# Plot real data
ggplot(data=rna_pre, aes(x=rna_t, y=rna_t_minus_7, color=group)) +
geom_point() +
labs(title= "SARS-CoV-2 RNA in Wastewater - Regional Data") +
xlab("RNA level on day t (gc/day)") +
ylab("RNA level on day t-7 (gc/day)")
# Join all dataframes
sim_plot <- rbind(rna_r1_sim, rna_r2_sim, rna_r3_sim) %>%
drop_na()
g <- ggplot() +
geom_point(data=sim_plot, aes(x=rna_t, y=rna_t_minus_7, alpha=0.2,
shape=group)) +
geom_point(data = rna_pre, aes(x=rna_t, y=rna_t_minus_7, color=group, alpha=1)) +
labs(title= "SARS-CoV-2 RNA in Wastewater - Simulations and Regional Data") +
xlab("RNA level on day t (gc/day)") +
ylab("RNA level on day t-7 (gc/day)") +
labs(shape="R0 (Simulation)", colour="Regions") +
scale_shape(labels = c("1.5 (\u03b2=0.15)","2 (\u03b2=0.2)","3 (\u03b2=0.3)")) +
coord_cartesian(ylim = c(0, 2e13), xlim = c(0, 2e13))
g + guides(alpha='none')
# Export plot and results
ggsave("plots/Compartmental combined.png", width = 8, height = 4.5, units = "in")
g <- ggplot() +
geom_point(data=sim_plot, aes(x=rna_t, y=rna_t_minus_7, alpha=0.2,
shape=group)) +
geom_point(data = rna_pre, aes(x=rna_t, y=rna_t_minus_7, color=group, alpha=1)) +
labs(title= "SARS-CoV-2 RNA in Wastewater - Simulations and Regional Data") +
xlab("RNA level on day t (gc/day)") +
ylab("RNA level on day t-7 (gc/day)") +
labs(shape="\u03b2 for Simulation", colour="Regions") +
scale_shape(labels = c("0.15","0.2","0.3")) +
coord_cartesian(ylim = c(0, 2e13), xlim = c(0, 2e13))
g + guides(alpha='none')
# Export plot and results
ggsave("plots/Compartmental combined.png", width = 8, height = 4.5, units = "in")
g <- ggplot() +
geom_point(data=sim_plot, aes(x=rna_t, y=rna_t_minus_7, alpha=0.2,
shape=group)) +
geom_point(data = rna_pre, aes(x=rna_t, y=rna_t_minus_7, color=group, alpha=1)) +
labs(title= "SARS-CoV-2 RNA in Wastewater - Simulations and Regional Data") +
xlab("RNA level on day t (gc/day)") +
ylab("RNA level on day t-7 (gc/day)") +
labs(colour="Regions", shape="\u03b2 for Simulation") +
scale_shape(labels = c("0.15","0.2","0.3")) +
coord_cartesian(ylim = c(0, 2e13), xlim = c(0, 2e13))
g + guides(alpha='none')
# Change column names for joining
colnames(rna_r1_sim)=colnames(rna_r2_sim)=colnames(rna_r3_sim)=colnames(rna_pre) <-
c("rna_t", "rna_t_minus_7", "group")
# Plot
r1 <- ggplot(data=rna_r1_sim, aes(x=rna_t, y=rna_t_minus_7)) +
geom_point(color='green', size=1) +
labs(title= "\u03b2 = 0.15") +
xlab("RNA level on day t (gc/day)") +
ylab("RNA level on day t-7 (gc/day)") +
theme(legend.text=element_text(size=8)) +
scale_x_continuous(limits=c(0,2e14),
breaks=seq(0,2e14,1e14)) +
scale_y_continuous(limits=c(0,2e14))
r2 <- ggplot(data=rna_r2_sim, aes(x=rna_t, y=rna_t_minus_7)) +
geom_point(color='yellow', size=1) +
labs(title= "\u03b2 = 0.2") +
xlab("RNA level on day t (gc/day)") +
ylab("RNA level on day t-7 (gc/day)") +
theme(legend.text=element_text(size=8)) +
scale_x_continuous(limits=c(0,2e14),
breaks=seq(0,2e14,1e14)) +
scale_y_continuous(limits=c(0,2e14))
r3 <- ggplot(data=rna_r3_sim, aes(x=rna_t, y=rna_t_minus_7)) +
geom_point(color='blue', size=1) +
labs(title= "\u03b2 = 0.3") +
xlab("RNA level on day t (gc/day)") +
ylab("RNA level on day t-7 (gc/day)") +
theme(legend.text=element_text(size=8)) +
scale_x_continuous(limits=c(0,2e14),
breaks=seq(0,2e14,1e14))
# Show three graphs horizontally
r1 + r2 + r3
ggsave("plots/Betas combined.png", width = 8, height = 3, units = "in")
# Plot real data
ggplot(data=rna_pre, aes(x=rna_t, y=rna_t_minus_7, color=group)) +
geom_point() +
labs(title= "SARS-CoV-2 RNA in Wastewater - Regional Data") +
xlab("RNA level on day t (gc/day)") +
ylab("RNA level on day t-7 (gc/day)")
# Join all dataframes
sim_plot <- rbind(rna_r1_sim, rna_r2_sim, rna_r3_sim) %>%
drop_na()
g <- ggplot() +
geom_point(data=sim_plot, aes(x=rna_t, y=rna_t_minus_7, alpha=0.2,
shape=group)) +
geom_point(data = rna_pre, aes(x=rna_t, y=rna_t_minus_7, color=group, alpha=1)) +
labs(title= "SARS-CoV-2 RNA in Wastewater - Simulations and Regional Data") +
xlab("RNA level on day t (gc/day)") +
ylab("RNA level on day t-7 (gc/day)") +
labs(colour="Regions", shape="\u03b2 for Simulation") +
scale_shape(labels = c("0.15","0.2","0.3")) +
coord_cartesian(ylim = c(0, 2e13), xlim = c(0, 2e13))
g + guides(alpha='none')
# Export plot and results
ggsave("plots/Compartmental combined.png", width = 8, height = 4.5, units = "in")
r3 <- ggplot(data=rna_r3_sim, aes(x=rna_t, y=rna_t_minus_7)) +
geom_point(color='blue', size=1) +
labs(title= "\u03b2 = 0.3") +
xlab("RNA Level on Day t (gc/day)") +
ylab("RNA Level on Day t-7 (gc/day)") +
theme(legend.text=element_text(size=8)) +
scale_x_continuous(limits=c(0,2e14),
breaks=seq(0,2e14,1e14))
# Show three graphs horizontally
r1 + r2 + r3
ggsave("plots/Betas combined.png", width = 8, height = 3, units = "in")
# Plot real data
ggplot(data=rna_pre, aes(x=rna_t, y=rna_t_minus_7, color=group)) +
geom_point() +
labs(title= "SARS-CoV-2 RNA in Wastewater - Regional Data") +
xlab("RNA Level on Day t (gc/day)") +
ylab("RNA Level on Day t-7 (gc/day)")
# Join all dataframes
sim_plot <- rbind(rna_r1_sim, rna_r2_sim, rna_r3_sim) %>%
drop_na()
g <- ggplot() +
geom_point(data=sim_plot, aes(x=rna_t, y=rna_t_minus_7, alpha=0.2,
shape=group)) +
geom_point(data = rna_pre, aes(x=rna_t, y=rna_t_minus_7, color=group, alpha=1)) +
labs(title= "SARS-CoV-2 RNA in Wastewater - Simulations and Regional Data") +
xlab("RNA Level on Day t (gc/day)") +
ylab("RNA Level on Day t-7 (gc/day)") +
labs(colour="Regions", shape="\u03b2 for Simulation") +
scale_shape(labels = c("0.15","0.2","0.3")) +
coord_cartesian(ylim = c(0, 2e13), xlim = c(0, 2e13))
g + guides(alpha='none')
# Plot
r1 <- ggplot(data=rna_r1_sim, aes(x=rna_t, y=rna_t_minus_7)) +
geom_point(color='green', size=1) +
labs(title= "\u03b2 = 0.15") +
xlab("RNA Level on Day t (gc/day)") +
ylab("RNA Level on Day t-7 (gc/day)") +
theme(legend.text=element_text(size=8)) +
scale_x_continuous(limits=c(0,2e14),
breaks=seq(0,2e14,1e14)) +
scale_y_continuous(limits=c(0,2e14))
r2 <- ggplot(data=rna_r2_sim, aes(x=rna_t, y=rna_t_minus_7)) +
geom_point(color='yellow', size=1) +
labs(title= "\u03b2 = 0.2") +
xlab("RNA Level on Day t (gc/day)") +
ylab("RNA Level on Day t-7 (gc/day)") +
theme(legend.text=element_text(size=8)) +
scale_x_continuous(limits=c(0,2e14),
breaks=seq(0,2e14,1e14)) +
scale_y_continuous(limits=c(0,2e14))
r3 <- ggplot(data=rna_r3_sim, aes(x=rna_t, y=rna_t_minus_7)) +
geom_point(color='blue', size=1) +
labs(title= "\u03b2 = 0.3") +
xlab("RNA Level on Day t (gc/day)") +
ylab("RNA Level on Day t-7 (gc/day)") +
theme(legend.text=element_text(size=8)) +
scale_x_continuous(limits=c(0,2e14),
breaks=seq(0,2e14,1e14))
# Show three graphs horizontally
r1 + r2 + r3
ggsave("plots/Betas combined.png", width = 8, height = 3, units = "in")
# Plot real data
ggplot(data=rna_pre, aes(x=rna_t, y=rna_t_minus_7, color=group)) +
geom_point() +
labs(title= "SARS-CoV-2 RNA in Wastewater - Regional Data") +
xlab("RNA Level on Day t (gc/day)") +
ylab("RNA Level on Day t-7 (gc/day)")
# Join all dataframes
sim_plot <- rbind(rna_r1_sim, rna_r2_sim, rna_r3_sim) %>%
drop_na()
g <- ggplot() +
geom_point(data=sim_plot, aes(x=rna_t, y=rna_t_minus_7, alpha=0.2,
shape=group)) +
geom_point(data = rna_pre, aes(x=rna_t, y=rna_t_minus_7, color=group, alpha=1)) +
labs(title= "SARS-CoV-2 RNA in Wastewater - Simulations and Regional Data") +
xlab("RNA Level on Day t (gc/day)") +
ylab("RNA Level on Day t-7 (gc/day)") +
labs(colour="Regions", shape="\u03b2 for Simulation") +
scale_shape(labels = c("0.15","0.2","0.3")) +
coord_cartesian(ylim = c(0, 2e13), xlim = c(0, 2e13))
g + guides(alpha='none')
# Export plot and results
ggsave("plots/Compartmental combined.png", width = 8, height = 4.5, units = "in")
# Export simulation results
write_csv(table, "SEIR simulations.csv")
write_csv(sim_plot, "SEIR plot combined.csv")
